<ac:layout>
 <ac:layout-section ac:type="single">
  <ac:layout-cell>
   <p>
    <ac:placeholder>
     Add labels to this report to make it easy to find outages that relate to the service or the sites that were affected. That will help us find and report on relevant related issues.
    </ac:placeholder>
   </p>
   <ac:structured-macro ac:macro-id="6041cfab-a8b7-40c8-aa32-0229b207b0df" ac:name="excerpt" ac:schema-version="1">
    <ac:parameter ac:name="atlassian-macro-output-type">
     INLINE
    </ac:parameter>
    <ac:rich-text-body>
     <p>
      SIR for boltsub3 on
      <time datetime="2023-03-12">
      </time>
     </p>
    </ac:rich-text-body>
   </ac:structured-macro>
   <p class="auto-cursor-target">
    <br/>
   </p>
  </ac:layout-cell>
 </ac:layout-section>
 <ac:layout-section ac:type="two_equal">
  <ac:layout-cell>
   <p class="auto-cursor-target">
    <br/>
   </p>
   <ac:structured-macro ac:macro-id="b2a57857-7f56-44d2-a0d4-91b3d7ebfcbf" ac:name="toc-zone" ac:schema-version="1">
    <ac:rich-text-body>
     <p>
      <ac:structured-macro ac:macro-id="58b18781-a929-4005-a5e0-2ef23adca3fe" ac:name="toc" ac:schema-version="1">
      </ac:structured-macro>
     </p>
    </ac:rich-text-body>
   </ac:structured-macro>
   <p class="auto-cursor-target">
    <br/>
   </p>
  </ac:layout-cell>
  <ac:layout-cell>
   <p class="auto-cursor-target">
    <br/>
   </p>
   <ac:structured-macro ac:macro-id="0db3d9b8-3a8d-4ad4-ae26-0a4ea4bc95c2" ac:name="details" ac:schema-version="1">
    <ac:parameter ac:name="id">
     SIR-metadata
    </ac:parameter>
    <ac:rich-text-body>
     <p class="auto-cursor-target">
      <br/>
     </p>
     <table class="wrapped" style="letter-spacing: 0.0px;">
      <colgroup>
       <col/>
       <col/>
      </colgroup>
      <tbody>
       <tr>
        <th colspan="1">
         System/Service
        </th>
        <td colspan="1">
         <div class="content-wrapper">
          <p>
           <ac:link>
            <ri:page ri:content-title="Bolt Cluster" ri:space-key="SYSMGR">
            </ri:page>
           </ac:link>
          </p>
         </div>
        </td>
       </tr>
       <tr>
        <th>
         Ticket(s)
        </th>
        <td>
         <div class="content-wrapper">
          <p>
           <ac:structured-macro ac:macro-id="b47fbc60-269a-450e-af61-8d6980f41a9b" ac:name="jira" ac:schema-version="1">
            <ac:parameter ac:name="server">
             System JIRA
            </ac:parameter>
            <ac:parameter ac:name="serverId">
             ac6def98-2140-30c3-8103-4b52b8b31135
            </ac:parameter>
            <ac:parameter ac:name="key">
             ITHPC-292
            </ac:parameter>
           </ac:structured-macro>
          </p>
         </div>
        </td>
       </tr>
       <tr>
        <th colspan="1">
         Outage scope
        </th>
        <td colspan="1">
         bolt
        </td>
       </tr>
       <tr>
        <th>
         Outage date
        </th>
        <td>
         <div class="content-wrapper">
          <p>
           <time datetime="2023-03-12">
           </time>
          </p>
         </div>
        </td>
       </tr>
       <tr>
        <th>
         Report date
        </th>
        <td>
         <div class="content-wrapper">
          <p>
           <time datetime="2023-03-13">
           </time>
          </p>
         </div>
        </td>
       </tr>
       <tr>
        <th colspan="1">
         Report filed by
        </th>
        <td colspan="1">
         <ac:link>
          <ri:user ri:userkey="557058:07ac0593-24aa-4f1a-9f61-f6ed48eb34e3">
          </ri:user>
         </ac:link>
        </td>
       </tr>
       <tr>
        <th colspan="1">
         Report reviewed date
        </th>
        <td colspan="1">
         <div class="content-wrapper">
          <p>
           <time datetime="2023-03-23">
           </time>
          </p>
         </div>
        </td>
       </tr>
       <tr>
        <th colspan="1">
         Reviewed by
        </th>
        <td colspan="1">
         <div class="content-wrapper">
          <p>
           <ac:link>
            <ri:user ri:userkey="557058:07ac0593-24aa-4f1a-9f61-f6ed48eb34e3">
            </ri:user>
           </ac:link>
           <ac:link>
            <ri:user ri:userkey="557058:effc737d-8d3c-474e-b2cc-806826c91787">
            </ri:user>
           </ac:link>
           <ac:link>
            <ri:user ri:userkey="640b97dd93cf25994632639f">
            </ri:user>
           </ac:link>
           <ac:link>
            <ri:user ri:userkey="712020:2948fddc-839a-4d9a-bfb1-24613d953ca0">
            </ri:user>
           </ac:link>
           <ac:link>
            <ri:user ri:userkey="712020:20683bcb-b5d6-4474-a40c-2a3ae5aaee4f">
            </ri:user>
           </ac:link>
           <ac:link>
            <ri:user ri:userkey="5d405c8181cbd30da3475cdf">
            </ri:user>
           </ac:link>
           <ac:link>
            <ri:user ri:userkey="712020:09d25112-c53f-471d-87a5-b60a2c56fc90">
            </ri:user>
           </ac:link>
           <ac:link>
            <ri:user ri:userkey="712020:460d116b-6dd0-4201-9370-8098156f6d6f">
            </ri:user>
           </ac:link>
           <ac:link>
            <ri:user ri:userkey="557058:037cebc0-7a1a-4a12-af72-7583a24ff5d6">
            </ri:user>
           </ac:link>
           <ac:link>
            <ri:user ri:userkey="557058:c11a8693-7dcc-4232-aa9d-d1adf489eef8">
            </ri:user>
           </ac:link>
          </p>
         </div>
        </td>
       </tr>
      </tbody>
     </table>
     <p class="auto-cursor-target">
      <br/>
     </p>
    </ac:rich-text-body>
   </ac:structured-macro>
   <p class="auto-cursor-target">
    <br/>
   </p>
  </ac:layout-cell>
 </ac:layout-section>
 <ac:layout-section ac:type="single">
  <ac:layout-cell>
   <h2>
    Executive summary
   </h2>
   <hr/>
   <p>
    Users reported in the IT Support Hotline having problems submitting jobs to bolt, and the error messages indicated a problem with the PostgreSQL database on boltsub3.  We found the service had stopped because the /srv disk was full. We freed space and restarted the
    <span style="color: rgb(66,66,66);">
     jobserverd-postgres.service service.
    </span>
   </p>
   <h2>
    <span>
     Background
    </span>
   </h2>
   <hr/>
   <p>
    The Job Server Team (
    <ac:link>
     <ri:user ri:userkey="557058:e667f89b-155f-4fbe-b18c-b523aac1e363">
     </ri:user>
    </ac:link>
    ,
    <a href="https://groups.google.com/a/schrodinger.com/g/job-server-reviews-group/members">
     job-server-reviews-group
    </a>
    ) maintains the jobserver service on boltsub3. This service relies on a PostgreSQL database running on boltsub3, and uses the /srv local disk.
   </p>
   <h2>
    Incident Description
   </h2>
   <hr/>
   <p>
    Users reported in the IT Support Hotline having problems submitting jobs to bolt, and the error messages indicated a problem with the PostgreSQL database on boltsub3.
   </p>
   <ac:structured-macro ac:macro-id="eabb366f-4609-431e-9b91-6037d5cf9042" ac:name="code" ac:schema-version="1">
    <ac:plain-text-body>
     <![CDATA[Error(s) in searching authenticated servers for the given -HOST:
  - server boltsub3.schrodinger.com:8030: rpc error: code = Unknown desc = could not connect to postgres database: dial tcp 127.0.0.1:5432: connect: connection refused]]>
    </ac:plain-text-body>
   </ac:structured-macro>
   <p>
    <span style="letter-spacing: 0.0px;">
     We found the
     <span style="color: rgb(66,66,66);">
      jobserverd-postgres.service
     </span>
     had stopped.  We restarted it, then noticed /srv was full, and that the service stopped again.  We realized the database was hosted on /srv and needed more space. We freed space and restarted the
    </span>
    <span style="color: rgb(66,66,66);">
     jobserverd-postgres.service service.
    </span>
   </p>
   <h3>
    Chronology
   </h3>
   <p>
    Sun 3/12/23 Eastern time
   </p>
   <p>
    5:31pm
    <span class="nzVtF" style="color: rgb(32,33,36);">
     <span class="ZTmjQb Z4BnXb GeBN2b">
      <span class="njhDLd O5OMdc">
       Xiaohu Hu reported an issue launching jobs in the IT Support Hotline and later, listing his job database
      </span>
     </span>
    </span>
   </p>
   <p>
    <span class="nzVtF" style="color: rgb(32,33,36);">
     <span class="ZTmjQb Z4BnXb GeBN2b">
      <span class="njhDLd O5OMdc">
       6:28pm
       <ac:link>
        <ri:user ri:userkey="557058:dd3ca0b8-81b7-46aa-8e00-307cacc52045">
        </ri:user>
       </ac:link>
       starts investigation; the issue isn't clear, but Xiaohu says it's not an urgent issue for this weekend
       <br/>
      </span>
     </span>
    </span>
   </p>
   <p>
    <span class="nzVtF" style="color: rgb(32,33,36);">
     <span class="ZTmjQb Z4BnXb GeBN2b">
      <span class="njhDLd O5OMdc">
       <span style="color: rgb(95,99,104);">
        10:57 PM Edward Miller reports being able to submit jobs from boltsub1, and the errors indicate a problem with postgres on boltsub3
       </span>
      </span>
     </span>
    </span>
   </p>
   <p>
    <span class="nzVtF" style="color: rgb(32,33,36);">
     <span class="ZTmjQb Z4BnXb GeBN2b">
      <span class="njhDLd O5OMdc">
       <span style="color: rgb(95,99,104);">
        11:21pm
        <ac:link>
         <ri:user ri:userkey="557058:dd3ca0b8-81b7-46aa-8e00-307cacc52045">
         </ri:user>
        </ac:link>
        asks for help in the IT SOS room
       </span>
      </span>
     </span>
    </span>
   </p>
   <p>
    <span class="nzVtF" style="color: rgb(32,33,36);">
     <span class="ZTmjQb Z4BnXb GeBN2b">
      <span class="njhDLd O5OMdc">
       <span style="color: rgb(95,99,104);">
        11:29pm 12:08am
        <ac:link>
         <ri:user ri:userkey="557058:07ac0593-24aa-4f1a-9f61-f6ed48eb34e3">
         </ri:user>
        </ac:link>
        started investigating. Found a problem with
        <span style="color: rgb(66,66,66);">
         jobserverd-postgres.service and
         <ac:link>
          <ri:user ri:userkey="557058:dd3ca0b8-81b7-46aa-8e00-307cacc52045">
          </ri:user>
         </ac:link>
         restarted it .
         <ac:link>
          <ri:user ri:userkey="557058:07ac0593-24aa-4f1a-9f61-f6ed48eb34e3">
          </ri:user>
         </ac:link>
         saw /srv was full, and freed space there, then restarted jobserverd-postgres.service again.
        </span>
       </span>
      </span>
     </span>
    </span>
   </p>
   <p>
    <span class="nzVtF" style="color: rgb(32,33,36);">
     <span class="ZTmjQb Z4BnXb GeBN2b">
      <span class="njhDLd O5OMdc">
       <span style="color: rgb(95,99,104);">
        <span style="color: rgb(66,66,66);">
         12:12am Noticed free space was decreasing again, then started increasing.
        </span>
       </span>
      </span>
     </span>
    </span>
   </p>
   <p>
    <span class="nzVtF" style="color: rgb(32,33,36);">
     <span class="ZTmjQb Z4BnXb GeBN2b">
      <span class="njhDLd O5OMdc">
       <span style="color: rgb(95,99,104);">
        <span style="color: rgb(66,66,66);">
         1:20am
         <ac:link>
          <ri:user ri:userkey="557058:dd3ca0b8-81b7-46aa-8e00-307cacc52045">
          </ri:user>
         </ac:link>
         found some potential files in
         <span style="color: rgb(32,33,36);">
          /srv/jobserverd/filestore/content through
         </span>
         which free space might have been getting cleaned up, but it wasn't clear if they were functional/in use.
        </span>
       </span>
      </span>
     </span>
    </span>
   </p>
   <p>
    <span class="nzVtF" style="color: rgb(32,33,36);">
     <span class="ZTmjQb Z4BnXb GeBN2b">
      <span class="njhDLd O5OMdc">
       <span style="color: rgb(95,99,104);">
        <span style="color: rgb(66,66,66);">
         2:05am
         <ac:link>
          <ri:user ri:userkey="557058:8aff9fa7-fab5-4a58-8371-4bbe29336cd2">
          </ri:user>
         </ac:link>
         reports 500GB free, sends email to cluster-group@.
        </span>
       </span>
      </span>
     </span>
    </span>
   </p>
   <h3>
    Corrective Action
   </h3>
   <p>
    Freed space in /srv and restarted the
    <span class="nzVtF" style="color: rgb(32,33,36);">
     <span class="ZTmjQb Z4BnXb GeBN2b">
      <span class="njhDLd O5OMdc">
       <span style="color: rgb(95,99,104);">
        <span style="color: rgb(66,66,66);">
         jobserverd-postgres.service service.
        </span>
       </span>
      </span>
     </span>
    </span>
   </p>
   <h3>
    Analysis
   </h3>
   <p>
    <ac:placeholder>
     Describe any findings (other than this report itself)
    </ac:placeholder>
   </p>
   <h3>
    Introduced Issues
   </h3>
   <p>
    <ac:placeholder>
     Edit the macro below to replace the issue ID in the JQL query
    </ac:placeholder>
   </p>
   <p>
    <ac:structured-macro ac:macro-id="06150dfb-e501-4274-94df-5fca2abc35b1" ac:name="jira" ac:schema-version="1">
     <ac:parameter ac:name="server">
      System JIRA
     </ac:parameter>
     <ac:parameter ac:name="columnIds">
      issuekey,priority,status,summary,created,updated,reporter,customfield_11008
     </ac:parameter>
     <ac:parameter ac:name="columns">
      key,priority,status,summary,created,updated,reporter,Sprint
     </ac:parameter>
     <ac:parameter ac:name="maximumIssues">
      20
     </ac:parameter>
     <ac:parameter ac:name="jqlQuery">
      issue in linkedIssues(ITDW-123, "introduced")
     </ac:parameter>
     <ac:parameter ac:name="serverId">
      ac6def98-2140-30c3-8103-4b52b8b31135
     </ac:parameter>
    </ac:structured-macro>
   </p>
   <h2>
    Detection
   </h2>
   <hr/>
   <h3>
    How quickly was the problem detected?
   </h3>
   <p>
    The first user report was at 5:31pm
   </p>
   <p>
    /srv filled up Mar 12 20:41:41 boltsub3 bash: Failed to write to log, write /srv/jobserverd/logs/jobserverd.log: no space left on device
   </p>
   <p>
    Based on the time, it seems the earliest report was not related to /srv filling up.
   </p>
   <p>
    Ed Miller's report at 10:57pm is around 2 hours after /srv filled up.
   </p>
   <p>
    <ac:placeholder>
     Describe how soon after the advent of the bad action or incident we did, should or could have been aware of it. If an automated system identified the problem even if we ignored it please use this as the point of detection.
    </ac:placeholder>
   </p>
   <h3>
    How was the problem detected?
   </h3>
   <p>
    User report in the IT Support Hotline
   </p>
   <h3>
    How can detection be improved?
   </h3>
   <p>
    Add boltsub3 to LibreNMS - DONE
    <ac:structured-macro ac:macro-id="895f378a-8630-4958-be76-06b89897c065" ac:name="jira" ac:schema-version="1">
     <ac:parameter ac:name="server">
      System JIRA
     </ac:parameter>
     <ac:parameter ac:name="serverId">
      ac6def98-2140-30c3-8103-4b52b8b31135
     </ac:parameter>
     <ac:parameter ac:name="key">
      ITHPC-295
     </ac:parameter>
    </ac:structured-macro>
   </p>
   <h2>
    Response
   </h2>
   <hr/>
   <h3>
    How quickly did we respond once detected?
   </h3>
   <p>
    If the real issue was /srv filling up at 20:41:41, then we responded within ~2 hours, at 10:57pm.
   </p>
   <h3>
    Did we adequately communicate to our users?
   </h3>
   <p>
    Yes, replied in the hotline, and sent an email to cluster-group@.
   </p>
   <h3>
    If not, how can this be improved?
   </h3>
   <p>
    <ac:placeholder>
     Describe here any ways we can or should make our communication better.
    </ac:placeholder>
   </p>
   <h2>
    Mitigation
   </h2>
   <hr/>
   <h3>
    What went well that helped minimize the impact of this problem?
   </h3>
   <p>
    It was relatively quick to find the immediate cause and address it.
   </p>
   <h3>
    What can be done to minimize the impact if a problem like this recurs?
   </h3>
   <p>
    See
    <ac:link ac:anchor="Jobservertroubleshooting">
     <ri:page ri:content-title="Job server on bolt cluster" ri:space-key="SYSMGR">
     </ri:page>
    </ac:link>
   </p>
   <h2>
    Avoidance
   </h2>
   <hr/>
   <h3>
    What can we do in the future to avoid a problem like this?
   </h3>
   <p>
    <ac:link>
     <ri:user ri:userkey="557058:e667f89b-155f-4fbe-b18c-b523aac1e363">
     </ri:user>
    </ac:link>
    wrote: "filed
    <ac:structured-macro ac:macro-id="33eda431-e4f5-4f26-b5df-7014616e95a3" ac:name="jira" ac:schema-version="1">
     <ac:parameter ac:name="server">
      System JIRA
     </ac:parameter>
     <ac:parameter ac:name="serverId">
      ac6def98-2140-30c3-8103-4b52b8b31135
     </ac:parameter>
     <ac:parameter ac:name="key">
      JOBCON-8162
     </ac:parameter>
    </ac:structured-macro>
    <span style="color: rgb(23,43,77);">
     for follow up. Determined that the threshold being used on boltsub3 was the default (1G), which is way too small for that setup. Bumped this to 50G until we have a chance to address JOBCON-8162."
    </span>
   </p>
   <p>
    Adding boltsub3 to LibreNMS will give us alerting for if disk space starts to fill up again - DONE
    <ac:structured-macro ac:macro-id="ba00148f-cd48-406c-93fd-738de793087a" ac:name="jira" ac:schema-version="1">
     <ac:parameter ac:name="server">
      System JIRA
     </ac:parameter>
     <ac:parameter ac:name="serverId">
      ac6def98-2140-30c3-8103-4b52b8b31135
     </ac:parameter>
     <ac:parameter ac:name="key">
      ITHPC-295
     </ac:parameter>
    </ac:structured-macro>
   </p>
   <p>
    Adding /srv monitoring to monit and sending alerts when /srv usage exceeds 90% to
    <a href="mailto:it-help@schrodinger.com">
     it-help@schrodinger.com
    </a>
    and
    <a href="mailto:cluster-group@schrodinger.com.">
     cluster-group@schrodinger.com.
    </a>
    - DONE
    <ac:structured-macro ac:macro-id="d9f240ae-f98f-4b15-8be4-50310beba43d" ac:name="jira" ac:schema-version="1">
     <ac:parameter ac:name="server">
      System JIRA
     </ac:parameter>
     <ac:parameter ac:name="serverId">
      ac6def98-2140-30c3-8103-4b52b8b31135
     </ac:parameter>
     <ac:parameter ac:name="key">
      ITHPC-295
     </ac:parameter>
    </ac:structured-macro>
   </p>
   <h2>
    Next Actions
   </h2>
   <hr/>
   <p>
    <ac:placeholder>
     After analyzing and talking about this incident what actions did the reviewers and management decide should be done to address shortfalls in detection, mitigation or avoidance. Use tasks, assignments and due dates or link to created jira tickets.
    </ac:placeholder>
   </p>
   <ac:task-list>
    <ac:task>
     <ac:task-id>
      1
     </ac:task-id>
     <ac:task-status>
      complete
     </ac:task-status>
     <ac:task-body>
      <ac:structured-macro ac:macro-id="2741f32a-08c6-4932-9932-5799c668c003" ac:name="jira" ac:schema-version="1">
       <ac:parameter ac:name="server">
        System JIRA
       </ac:parameter>
       <ac:parameter ac:name="serverId">
        ac6def98-2140-30c3-8103-4b52b8b31135
       </ac:parameter>
       <ac:parameter ac:name="key">
        ITHPC-295
       </ac:parameter>
      </ac:structured-macro>
     </ac:task-body>
    </ac:task>
    <ac:task>
     <ac:task-id>
      3
     </ac:task-id>
     <ac:task-status>
      incomplete
     </ac:task-status>
     <ac:task-body>
      <strong>
       Rule: If an alert gets created add information to an article that explains the alert!
      </strong>
     </ac:task-body>
    </ac:task>
   </ac:task-list>
   <h2>
    Related articles
   </h2>
   <hr/>
   <p>
    <ac:placeholder>
     Related articles appear here based on the labels you select. Click to edit the macro and add or change labels.
    </ac:placeholder>
   </p>
   <p>
    <ac:structured-macro ac:macro-id="ffeb327a-3070-4405-823e-4605184c1568" ac:name="contentbylabel" ac:schema-version="4">
     <ac:parameter ac:name="showLabels">
      false
     </ac:parameter>
     <ac:parameter ac:name="max">
      5
     </ac:parameter>
     <ac:parameter ac:name="spaces">
      SYSMGR
     </ac:parameter>
     <ac:parameter ac:name="showSpace">
      false
     </ac:parameter>
     <ac:parameter ac:name="sort">
      modified
     </ac:parameter>
     <ac:parameter ac:name="reverse">
      true
     </ac:parameter>
     <ac:parameter ac:name="type">
      page
     </ac:parameter>
     <ac:parameter ac:name="cql">
      label = "kb-how-to-article" and type = "page" and space = "SYSMGR"
     </ac:parameter>
     <ac:parameter ac:name="labels">
      kb-how-to-article
     </ac:parameter>
    </ac:structured-macro>
   </p>
   <ac:structured-macro ac:macro-id="b77901a8-fc07-43f9-b345-36673b35c2e9" ac:name="details" ac:schema-version="1">
    <ac:parameter ac:name="hidden">
     true
    </ac:parameter>
    <ac:rich-text-body>
     <p class="auto-cursor-target">
      <br/>
     </p>
     <table class="wrapped">
      <colgroup>
       <col/>
       <col/>
      </colgroup>
      <tbody>
       <tr>
        <th>
         Related issues
        </th>
        <td>
         <br/>
        </td>
       </tr>
      </tbody>
     </table>
     <p class="auto-cursor-target">
      <br/>
     </p>
    </ac:rich-text-body>
   </ac:structured-macro>
   <p class="auto-cursor-target">
    <br/>
   </p>
  </ac:layout-cell>
 </ac:layout-section>
</ac:layout>
