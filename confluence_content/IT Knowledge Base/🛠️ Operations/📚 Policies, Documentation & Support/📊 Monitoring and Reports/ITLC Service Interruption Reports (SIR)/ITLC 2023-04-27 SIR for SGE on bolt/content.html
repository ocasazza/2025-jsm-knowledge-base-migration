<ac:layout>
 <ac:layout-section ac:type="single">
  <ac:layout-cell>
   <p>
    <ac:placeholder>
     Add labels to this report to make it easy to find outages that relate to the service or the sites that were affected. That will help us find and report on relevant related issues.
    </ac:placeholder>
   </p>
   <ac:structured-macro ac:macro-id="6041cfab-a8b7-40c8-aa32-0229b207b0df" ac:name="excerpt" ac:schema-version="1">
    <ac:parameter ac:name="atlassian-macro-output-type">
     INLINE
    </ac:parameter>
    <ac:rich-text-body>
     <p>
      SIR for SGE on bolt on
      <time datetime="2023-04-26">
      </time>
     </p>
    </ac:rich-text-body>
   </ac:structured-macro>
   <p class="auto-cursor-target">
    <br/>
   </p>
  </ac:layout-cell>
 </ac:layout-section>
 <ac:layout-section ac:type="two_equal">
  <ac:layout-cell>
   <p class="auto-cursor-target">
    <br/>
   </p>
   <ac:structured-macro ac:macro-id="b2a57857-7f56-44d2-a0d4-91b3d7ebfcbf" ac:name="toc-zone" ac:schema-version="1">
    <ac:rich-text-body>
     <p>
      <ac:structured-macro ac:macro-id="58b18781-a929-4005-a5e0-2ef23adca3fe" ac:name="toc" ac:schema-version="1">
      </ac:structured-macro>
     </p>
    </ac:rich-text-body>
   </ac:structured-macro>
   <p class="auto-cursor-target">
    <br/>
   </p>
  </ac:layout-cell>
  <ac:layout-cell>
   <p class="auto-cursor-target">
    <br/>
   </p>
   <ac:structured-macro ac:macro-id="0db3d9b8-3a8d-4ad4-ae26-0a4ea4bc95c2" ac:name="details" ac:schema-version="1">
    <ac:parameter ac:name="id">
     SIR-metadata
    </ac:parameter>
    <ac:rich-text-body>
     <p class="auto-cursor-target">
      <br/>
     </p>
     <table class="wrapped" style="letter-spacing: 0.0px;">
      <colgroup>
       <col/>
       <col/>
      </colgroup>
      <tbody>
       <tr>
        <th colspan="1">
         System/Service
        </th>
        <td colspan="1">
         <div class="content-wrapper">
          <p>
           <ac:link>
            <ri:page ri:content-title="Bolt Cluster" ri:space-key="SYSMGR">
            </ri:page>
           </ac:link>
          </p>
         </div>
        </td>
       </tr>
       <tr>
        <th>
         Ticket(s)
        </th>
        <td>
         <div class="content-wrapper">
          <p>
           <ac:structured-macro ac:macro-id="474b503d-f957-449a-ad59-fb6045aa74ec" ac:name="jira" ac:schema-version="1">
            <ac:parameter ac:name="server">
             System JIRA
            </ac:parameter>
            <ac:parameter ac:name="serverId">
             ac6def98-2140-30c3-8103-4b52b8b31135
            </ac:parameter>
            <ac:parameter ac:name="key">
             ITHPC-348
            </ac:parameter>
           </ac:structured-macro>
          </p>
         </div>
        </td>
       </tr>
       <tr>
        <th colspan="1">
         Outage scope
        </th>
        <td colspan="1">
         <ac:placeholder>
          If the outage was limited to a site(s) please link to the confluence location page(s)
         </ac:placeholder>
        </td>
       </tr>
       <tr>
        <th>
         Outage date
        </th>
        <td>
         <div class="content-wrapper">
          <p>
           <time datetime="2023-04-26">
           </time>
          </p>
         </div>
        </td>
       </tr>
       <tr>
        <th>
         Report date
        </th>
        <td>
         <div class="content-wrapper">
          <p>
           <time datetime="2023-04-26">
           </time>
          </p>
         </div>
        </td>
       </tr>
       <tr>
        <th colspan="1">
         Report filed by
        </th>
        <td colspan="1">
         <ac:link>
          <ri:user ri:userkey="557058:07ac0593-24aa-4f1a-9f61-f6ed48eb34e3">
          </ri:user>
         </ac:link>
        </td>
       </tr>
       <tr>
        <th colspan="1">
         Report reviewed date
        </th>
        <td colspan="1">
         <div class="content-wrapper">
          <p>
           <time datetime="2023-05-04">
           </time>
          </p>
         </div>
        </td>
       </tr>
       <tr>
        <th colspan="1">
         Reviewed by
        </th>
        <td colspan="1">
         <ac:link>
          <ri:user ri:userkey="557058:8aff9fa7-fab5-4a58-8371-4bbe29336cd2">
          </ri:user>
         </ac:link>
        </td>
       </tr>
      </tbody>
     </table>
     <p class="auto-cursor-target">
      <br/>
     </p>
    </ac:rich-text-body>
   </ac:structured-macro>
   <p class="auto-cursor-target">
    <br/>
   </p>
  </ac:layout-cell>
 </ac:layout-section>
 <ac:layout-section ac:type="single">
  <ac:layout-cell>
   <h2>
    Executive summary
   </h2>
   <hr/>
   <p>
    s
    <span style="color: black;letter-spacing: 0.0px;">
     ge_qmaster on the bolt head node had a segfault, and did not work properly after an automatic restart of that service.
     <span style="color: black;">
     </span>
     <span style="color: black;">
      /etc/init.d/sgemaster.bolt
     </span>
     had to be manually stopped and started
    </span>
    <span style="color: black;letter-spacing: 0.0px;">
     to fix the issue.
    </span>
   </p>
   <h2>
    <span>
     Background
    </span>
   </h2>
   <hr/>
   <p>
    <ac:placeholder>
     If this incident requires any background knowledge to understand or history that's relevant include it here.
    </ac:placeholder>
   </p>
   <h2>
    Incident Description
   </h2>
   <hr/>
   <p>
    <ac:link>
     <ri:user ri:userkey="557058:07ac0593-24aa-4f1a-9f61-f6ed48eb34e3">
     </ri:user>
    </ac:link>
    was paged by PagerDuty about an error with SGE on bolt.
    <span style="color: black;">
     /var/log/messages showed
    </span>
    <span style="color: black;">
     sge_qmaster had a segfault. It was restarted automatically, but did not work properly. Manually stopping and starting
    </span>
    <span style="color: black;">
     /etc/init.d/sgemaster.bolt fixed the issue.
    </span>
   </p>
   <p>
    <br/>
   </p>
   <p>
    <span style="color: rgb(0,0,0);">
     When qmaster process segfaulted, it did not exit properly and therefore left a pid file that still contains the previous process id, which caused  Monit service failed to re-start qmaster.  That's why Jon had to manually stop qmaster and then restarted it.   A change has been made so that once monit detects qmaster not running, it will first run stop command to clean up pid file and then start qmaster.
    </span>
   </p>
   <h3>
    Chronology
   </h3>
   <p>
    Eastern time
   </p>
   <p>
    10:16pm
    <ac:link>
     <ri:user ri:userkey="557058:07ac0593-24aa-4f1a-9f61-f6ed48eb34e3">
     </ri:user>
    </ac:link>
    paged by PagerDuty
    <a href="https://schrodinger-it.pagerduty.com/incidents/Q0L7UJPWVCFCGR">
     https://schrodinger-it.pagerduty.com/incidents/Q0L7UJPWVCFCGR
    </a>
    about an SGE error on bolt and started investigating
   </p>
   <p>
    10:34pm
    <ac:link>
     <ri:user ri:userkey="557058:07ac0593-24aa-4f1a-9f61-f6ed48eb34e3">
     </ri:user>
    </ac:link>
    manually stopped and started qmaster, and that seemed to fix the issue.
   </p>
   <p>
    11:38pm
    <ac:link>
     <ri:user ri:userkey="557058:07ac0593-24aa-4f1a-9f61-f6ed48eb34e3">
     </ri:user>
    </ac:link>
    sent an email to
    <a href="mailto:cluster-group@schrodinger.com">
     cluster-group@schrodinger.com
    </a>
    .
   </p>
   <p>
    <br/>
   </p>
   <h3>
    Corrective Action
   </h3>
   <p>
    Manually stopped and started qmaster, and that seemed to fix the issue.
   </p>
   <ac:structured-macro ac:macro-id="41d162cd-628e-4177-897f-b0a68b1fc0a1" ac:name="code" ac:schema-version="1">
    <ac:plain-text-body>
     <![CDATA[[root@bolt ~]# /etc/init.d/sgemaster.bolt stop
[root@bolt ~]# /bin/bash -c /etc/init.d/sgemaster.bolt start]]>
    </ac:plain-text-body>
   </ac:structured-macro>
   <p>
    <br/>
   </p>
   <h3>
    Analysis
   </h3>
   <p>
    sge_qmaster was using 24.6GB memory before it segfaulted. It was restarted automatically, but did not work properly.
   </p>
   <h3>
    Introduced Issues
   </h3>
   <p>
    <ac:placeholder>
     Edit the macro below to replace the issue ID in the JQL query
    </ac:placeholder>
   </p>
   <p>
    <ac:structured-macro ac:macro-id="1dcb527e-6cb6-45a4-a4a1-55cf9b51022f" ac:name="jira" ac:schema-version="1">
     <ac:parameter ac:name="server">
      System JIRA
     </ac:parameter>
     <ac:parameter ac:name="columnIds">
      issuekey,priority,status,summary,created,updated,reporter,customfield_11008
     </ac:parameter>
     <ac:parameter ac:name="columns">
      key,priority,status,summary,created,updated,reporter,Sprint
     </ac:parameter>
     <ac:parameter ac:name="maximumIssues">
      20
     </ac:parameter>
     <ac:parameter ac:name="jqlQuery">
      issue in linkedIssues(ITDW-123, "introduced")
     </ac:parameter>
     <ac:parameter ac:name="serverId">
      ac6def98-2140-30c3-8103-4b52b8b31135
     </ac:parameter>
    </ac:structured-macro>
   </p>
   <h2>
    Detection
   </h2>
   <hr/>
   <h3>
    How quickly was the problem detected?
   </h3>
   <p>
    Paged by PagerDuty once the issue was detected
   </p>
   <h3>
    How was the problem detected?
   </h3>
   <p>
    Automated detection:
   </p>
   <ac:structured-macro ac:macro-id="a6b0296c-72af-4369-a5d4-e399300f9bd8" ac:name="code" ac:schema-version="1">
    <ac:plain-text-body>
     <![CDATA[This alert is generated by /usr/local/sbin/send_sge_alert.sh on bolt via /etc/monit.d/sge]]>
    </ac:plain-text-body>
   </ac:structured-macro>
   <h3>
    How can detection be improved?
   </h3>
   <p>
    <ac:placeholder>
     If you have any ideas for ways this can be improved list or describe them here.
    </ac:placeholder>
   </p>
   <h2>
    Response
   </h2>
   <hr/>
   <h3>
    How quickly did we respond once detected?
   </h3>
   <p>
    Right away after being paged
   </p>
   <h3>
    Did we adequately communicate to our users?
   </h3>
   <p>
    Sent a message to cluster-group@schrodinger.com
   </p>
   <h3>
    If not, how can this be improved?
   </h3>
   <p>
    <ac:placeholder>
     Describe here any ways we can or should make our communication better.
    </ac:placeholder>
   </p>
   <h2>
    Mitigation
   </h2>
   <hr/>
   <h3>
    What went well that helped minimize the impact of this problem?
   </h3>
   <p>
    Automatic detection of the problem and being paged about it to address it right away.
   </p>
   <p>
    The error message identified the script which generated it, so we could examine what the script was checking.
   </p>
   <h3>
    What can be done to minimize the impact if a problem like this recurs?
   </h3>
   <p>
    Additional specific documentation in the alert message (for example
    <ac:structured-macro ac:macro-id="826c3095-6032-4742-adb3-02e579739a31" ac:name="jira" ac:schema-version="1">
     <ac:parameter ac:name="server">
      System JIRA
     </ac:parameter>
     <ac:parameter ac:name="serverId">
      ac6def98-2140-30c3-8103-4b52b8b31135
     </ac:parameter>
     <ac:parameter ac:name="key">
      ITHPC-349
     </ac:parameter>
    </ac:structured-macro>
    )
   </p>
   <p>
    <ac:link>
     <ri:user ri:userkey="557058:8aff9fa7-fab5-4a58-8371-4bbe29336cd2">
     </ri:user>
    </ac:link>
    implemented a change to
    <span style="color: rgb(23,43,77);">
     /etc/monit.d/qmaster in
    </span>
    <ac:structured-macro ac:macro-id="1d8d7b93-cd90-4ea8-b327-33edb3f1ba04" ac:name="jira" ac:schema-version="1">
     <ac:parameter ac:name="server">
      System JIRA
     </ac:parameter>
     <ac:parameter ac:name="serverId">
      ac6def98-2140-30c3-8103-4b52b8b31135
     </ac:parameter>
     <ac:parameter ac:name="key">
      ITHPC-348
     </ac:parameter>
    </ac:structured-macro>
   </p>
   <h2>
    Avoidance
   </h2>
   <hr/>
   <h3>
    What can we do in the future to avoid a problem like this?
   </h3>
   <p>
    <ac:link>
     <ri:user ri:userkey="557058:8aff9fa7-fab5-4a58-8371-4bbe29336cd2">
     </ri:user>
    </ac:link>
    implemented a change to
    <span style="color: rgb(23,43,77);">
     /etc/monit.d/qmaster in
    </span>
    <ac:structured-macro ac:macro-id="ecafc0ad-eaa8-438e-be51-7dec0b9ba9dd" ac:name="jira" ac:schema-version="1">
     <ac:parameter ac:name="server">
      System JIRA
     </ac:parameter>
     <ac:parameter ac:name="serverId">
      ac6def98-2140-30c3-8103-4b52b8b31135
     </ac:parameter>
     <ac:parameter ac:name="key">
      ITHPC-348
     </ac:parameter>
    </ac:structured-macro>
   </p>
   <h2>
    Next Actions
   </h2>
   <hr/>
   <p>
    <ac:placeholder>
     After analyzing and talking about this incident what actions did the reviewers and management decide should be done to address shortfalls in detection, mitigation or avoidance. Use tasks, assignments and due dates or link to created jira tickets.
    </ac:placeholder>
   </p>
   <ac:task-list>
    <ac:task>
     <ac:task-id>
      1
     </ac:task-id>
     <ac:task-status>
      incomplete
     </ac:task-status>
     <ac:task-body>
      <ac:structured-macro ac:macro-id="d48a3a04-d729-4f52-9a0c-5fc5d065d658" ac:name="jira" ac:schema-version="1">
       <ac:parameter ac:name="server">
        System JIRA
       </ac:parameter>
       <ac:parameter ac:name="serverId">
        ac6def98-2140-30c3-8103-4b52b8b31135
       </ac:parameter>
       <ac:parameter ac:name="key">
        ITHPC-349
       </ac:parameter>
      </ac:structured-macro>
     </ac:task-body>
    </ac:task>
   </ac:task-list>
   <h2>
    Related articles
   </h2>
   <hr/>
   <p>
    <ac:placeholder>
     Related articles appear here based on the labels you select. Click to edit the macro and add or change labels.
    </ac:placeholder>
   </p>
   <p>
    <ac:structured-macro ac:macro-id="ffeb327a-3070-4405-823e-4605184c1568" ac:name="contentbylabel" ac:schema-version="4">
     <ac:parameter ac:name="showLabels">
      false
     </ac:parameter>
     <ac:parameter ac:name="max">
      5
     </ac:parameter>
     <ac:parameter ac:name="spaces">
      SYSMGR
     </ac:parameter>
     <ac:parameter ac:name="showSpace">
      false
     </ac:parameter>
     <ac:parameter ac:name="sort">
      modified
     </ac:parameter>
     <ac:parameter ac:name="reverse">
      true
     </ac:parameter>
     <ac:parameter ac:name="type">
      page
     </ac:parameter>
     <ac:parameter ac:name="cql">
      label = "kb-how-to-article" and type = "page" and space = "SYSMGR"
     </ac:parameter>
     <ac:parameter ac:name="labels">
      kb-how-to-article
     </ac:parameter>
    </ac:structured-macro>
   </p>
   <ac:structured-macro ac:macro-id="b77901a8-fc07-43f9-b345-36673b35c2e9" ac:name="details" ac:schema-version="1">
    <ac:parameter ac:name="hidden">
     true
    </ac:parameter>
    <ac:rich-text-body>
     <p class="auto-cursor-target">
      <br/>
     </p>
     <table class="wrapped">
      <colgroup>
       <col/>
       <col/>
      </colgroup>
      <tbody>
       <tr>
        <th>
         Related issues
        </th>
        <td>
         <br/>
        </td>
       </tr>
      </tbody>
     </table>
     <p class="auto-cursor-target">
      <br/>
     </p>
    </ac:rich-text-body>
   </ac:structured-macro>
   <p class="auto-cursor-target">
    <br/>
   </p>
  </ac:layout-cell>
 </ac:layout-section>
</ac:layout>
