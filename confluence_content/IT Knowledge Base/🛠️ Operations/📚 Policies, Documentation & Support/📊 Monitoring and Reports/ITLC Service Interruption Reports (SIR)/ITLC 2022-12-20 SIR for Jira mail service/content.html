<ac:layout>
 <ac:layout-section ac:type="single">
  <ac:layout-cell>
   <p>
    <ac:placeholder>
     Add labels to this report to make it easy to find outages that relate to the service or the sites that were affected. That will help us find and report on relevant related issues.
    </ac:placeholder>
   </p>
   <ac:structured-macro ac:macro-id="6041cfab-a8b7-40c8-aa32-0229b207b0df" ac:name="excerpt" ac:schema-version="1">
    <ac:parameter ac:name="atlassian-macro-output-type">
     INLINE
    </ac:parameter>
    <ac:rich-text-body>
     <p>
      SIR for Jira mail service on 12/20/2022
     </p>
    </ac:rich-text-body>
   </ac:structured-macro>
   <p class="auto-cursor-target">
    <br/>
   </p>
  </ac:layout-cell>
 </ac:layout-section>
 <ac:layout-section ac:type="two_equal">
  <ac:layout-cell>
   <p class="auto-cursor-target">
    <br/>
   </p>
   <ac:structured-macro ac:macro-id="b2a57857-7f56-44d2-a0d4-91b3d7ebfcbf" ac:name="toc-zone" ac:schema-version="1">
    <ac:rich-text-body>
     <p>
      <ac:structured-macro ac:macro-id="58b18781-a929-4005-a5e0-2ef23adca3fe" ac:name="toc" ac:schema-version="1">
      </ac:structured-macro>
     </p>
    </ac:rich-text-body>
   </ac:structured-macro>
   <p class="auto-cursor-target">
    <br/>
   </p>
  </ac:layout-cell>
  <ac:layout-cell>
   <p class="auto-cursor-target">
    <br/>
   </p>
   <ac:structured-macro ac:macro-id="0db3d9b8-3a8d-4ad4-ae26-0a4ea4bc95c2" ac:name="details" ac:schema-version="1">
    <ac:parameter ac:name="id">
     SIR-metadata
    </ac:parameter>
    <ac:rich-text-body>
     <p class="auto-cursor-target">
      <br/>
     </p>
     <table class="wrapped" style="letter-spacing: 0.0px;">
      <colgroup>
       <col/>
       <col/>
      </colgroup>
      <tbody>
       <tr>
        <th colspan="1">
         System/Service
        </th>
        <td colspan="1">
         <div class="content-wrapper">
          <p>
           <ac:link>
            <ri:page ri:content-title="Jira Server" ri:space-key="SYSMGR">
            </ri:page>
           </ac:link>
          </p>
         </div>
        </td>
       </tr>
       <tr>
        <th>
         Ticket(s)
        </th>
        <td>
         <div class="content-wrapper">
          <p>
           <ac:structured-macro ac:macro-id="b1d1cfa3-bc3c-4d15-af52-bc1043d60134" ac:name="jira" ac:schema-version="1">
            <ac:parameter ac:name="server">
             System JIRA
            </ac:parameter>
            <ac:parameter ac:name="columnIds">
             issuekey,summary,issuetype,created,updated,duedate,assignee,reporter,priority,status,resolution
            </ac:parameter>
            <ac:parameter ac:name="columns">
             key,summary,type,created,updated,due,assignee,reporter,priority,status,resolution
            </ac:parameter>
            <ac:parameter ac:name="serverId">
             ac6def98-2140-30c3-8103-4b52b8b31135
            </ac:parameter>
            <ac:parameter ac:name="key">
             ITHPC-234
            </ac:parameter>
           </ac:structured-macro>
          </p>
         </div>
        </td>
       </tr>
       <tr>
        <th colspan="1">
         Outage scope
        </th>
        <td colspan="1">
         Affected inbound messages for Jira. All projects were affected
        </td>
       </tr>
       <tr>
        <th>
         Outage date
        </th>
        <td>
         <div class="content-wrapper">
          <p>
           <time datetime="2022-12-19">
           </time>
          </p>
         </div>
        </td>
       </tr>
       <tr>
        <th>
         Report date
        </th>
        <td>
         <div class="content-wrapper">
          <p>
           <time datetime="2022-12-20">
           </time>
          </p>
         </div>
        </td>
       </tr>
       <tr>
        <th colspan="1">
         Report filed by
        </th>
        <td colspan="1">
         <ac:link>
          <ri:user ri:userkey="557058:8aff9fa7-fab5-4a58-8371-4bbe29336cd2">
          </ri:user>
         </ac:link>
        </td>
       </tr>
       <tr>
        <th colspan="1">
         Report reviewed date
        </th>
        <td colspan="1">
         <div class="content-wrapper">
          <p>
           <time datetime="2023-01-12">
           </time>
          </p>
         </div>
        </td>
       </tr>
       <tr>
        <th colspan="1">
         Reviewed by
        </th>
        <td colspan="1">
         <ac:placeholder>
          List of people who had a part in reviewing or commenting on the report
         </ac:placeholder>
        </td>
       </tr>
      </tbody>
     </table>
     <p class="auto-cursor-target">
      <br/>
     </p>
    </ac:rich-text-body>
   </ac:structured-macro>
   <p class="auto-cursor-target">
    <br/>
   </p>
  </ac:layout-cell>
 </ac:layout-section>
 <ac:layout-section ac:type="single">
  <ac:layout-cell>
   <h2>
    Executive summary
   </h2>
   <hr/>
   <p>
    When implementing DKIM on pdx-mail-lv02, an out-of-date sendmail aliases file in ansible role "sendmail" was applied. This aliases file points to aws Jira/Jiratest for mail forwarding. As a result, incoming emails for Jira were not able to be delivered to production Jira nor test Jira server on GCP
   </p>
   <h2>
    <span>
     Background
    </span>
   </h2>
   <hr/>
   <p>
    Sendmail configuration for pdx-mail-lv02 is via ansible.  The role sendmail includes all sendmail configuration files for pdx-mail-lv02.  Any configuration changes should be recorded in the ansible role first and then pushed to pdx-mail-lv02.
   </p>
   <h2>
    Incident Description
   </h2>
   <hr/>
   Appteam reported that the order email was added to Jira tickets in
   <ac:structured-macro ac:macro-id="b101fa27-31ca-4147-842c-054ec173872c" ac:name="jira" ac:schema-version="1">
    <ac:parameter ac:name="server">
     System JIRA
    </ac:parameter>
    <ac:parameter ac:name="columnIds">
     issuekey,summary,issuetype,created,updated,duedate,assignee,reporter,priority,status,resolution
    </ac:parameter>
    <ac:parameter ac:name="columns">
     key,summary,type,created,updated,due,assignee,reporter,priority,status,resolution
    </ac:parameter>
    <ac:parameter ac:name="serverId">
     ac6def98-2140-30c3-8103-4b52b8b31135
    </ac:parameter>
    <ac:parameter ac:name="key">
     ITDW-616
    </ac:parameter>
   </ac:structured-macro>
   <h3>
    Chronology
   </h3>
   <p>
    At 10:08 AM PST
    <time datetime="2022-12-19">
    </time>
    ITINFRA team run ansible playbook, sendmail.yml, to implement DKIM on nyc-mail-lv01 and pdx-mail-lv02. Prior to applying the ansible playbook, /etc/mail/aliases on pdx-mail-lv02 had correct setting pointing to JIra and Jiratest servers on GCP.  However, the same aliases file in ansible role "sendmail" was still for AWS JIra and Jiratest servers. Therefore the out-of-date aliases was dropped in and replaced the current aliases
    <ac:structured-macro ac:macro-id="dec65bc1-9586-454c-ae5d-dc8e56950037" ac:name="jira" ac:schema-version="1">
     <ac:parameter ac:name="server">
      System JIRA
     </ac:parameter>
     <ac:parameter ac:name="columnIds">
      issuekey,summary,issuetype,created,updated,duedate,assignee,reporter,priority,status,resolution
     </ac:parameter>
     <ac:parameter ac:name="columns">
      key,summary,type,created,updated,due,assignee,reporter,priority,status,resolution
     </ac:parameter>
     <ac:parameter ac:name="serverId">
      ac6def98-2140-30c3-8103-4b52b8b31135
     </ac:parameter>
     <ac:parameter ac:name="key">
      ITINFRA-3
     </ac:parameter>
    </ac:structured-macro>
   </p>
   <p>
    At 5:05PM PST
    <time datetime="2022-12-19">
    </time>
    Appteam first reported the issue in
    <ac:structured-macro ac:macro-id="97348e01-7260-4509-9104-7c47487aa4bc" ac:name="jira" ac:schema-version="1">
     <ac:parameter ac:name="server">
      System JIRA
     </ac:parameter>
     <ac:parameter ac:name="columnIds">
      issuekey,summary,issuetype,created,updated,duedate,assignee,reporter,priority,status,resolution
     </ac:parameter>
     <ac:parameter ac:name="columns">
      key,summary,type,created,updated,due,assignee,reporter,priority,status,resolution
     </ac:parameter>
     <ac:parameter ac:name="serverId">
      ac6def98-2140-30c3-8103-4b52b8b31135
     </ac:parameter>
     <ac:parameter ac:name="key">
      ITDW-616
     </ac:parameter>
    </ac:structured-macro>
   </p>
   <p>
    At 9:30AM PST
    <time datetime="2022-12-20">
    </time>
    Sysmgr started looking into this issue  and resolved the issue by manually restoring /etc/mail/aliases. Then updated file "aliases" in ansible role "sendmail"
   </p>
   <p>
    At 10:28 AM PST
    <time datetime="2022-12-20">
    </time>
    Appteam confirmed the issue is resolved
    <ac:structured-macro ac:macro-id="6e1e4ad7-25fa-411f-9606-32932f124c99" ac:name="jira" ac:schema-version="1">
     <ac:parameter ac:name="server">
      System JIRA
     </ac:parameter>
     <ac:parameter ac:name="columnIds">
      issuekey,summary,issuetype,created,updated,duedate,assignee,reporter,priority,status,resolution
     </ac:parameter>
     <ac:parameter ac:name="columns">
      key,summary,type,created,updated,due,assignee,reporter,priority,status,resolution
     </ac:parameter>
     <ac:parameter ac:name="serverId">
      ac6def98-2140-30c3-8103-4b52b8b31135
     </ac:parameter>
     <ac:parameter ac:name="key">
      ITHPC-234
     </ac:parameter>
    </ac:structured-macro>
   </p>
   <h3>
    Corrective Action
   </h3>
   <p>
    Updated sendmail aliases file by replacing aws-jira-lv01/aws-jiratest-lv01 with gcp-jira-lv01/gcp-jiratest-lv01 first manually to restore mail service for Jira
   </p>
   <p>
    Updated ansible code for pdx-mail-lv02 aliases file. Tested applying updated ansible role "sendmail".  Correct aliases file is used now.
   </p>
   <h3>
    Analysis
   </h3>
   <p>
    We need to thoroughly test email flow for Jira inbound and outbound messages after making sendmail changes on pdx-mail-lv02.
   </p>
   <h3>
    Introduced Issues
   </h3>
   <h2>
    Detection
   </h2>
   <hr/>
   <h3>
    How quickly was the problem detected?
   </h3>
   <p>
    The issue was detected shortly after the sendmail configuration change was made by end users.
   </p>
   <h3>
    How was the problem detected?
   </h3>
   <p>
    By end users
   </p>
   <h3>
    How can detection be improved?
   </h3>
   <p>
    N/A
   </p>
   <h2>
    Response
   </h2>
   <hr/>
   <h3>
    How quickly did we respond once detected?
   </h3>
   <p>
    It took half day for sysmgr to investigate after the issue was reported
   </p>
   <h3>
    Did we adequately communicate to our users?
   </h3>
   <p>
    Yes, all communication was done via the Jira ticket. Updates are posted as soon as available
   </p>
   <h3>
    If not, how can this be improved?
   </h3>
   <p>
    N/A
   </p>
   <h2>
    Mitigation
   </h2>
   <hr/>
   <h3>
    What went well that helped minimize the impact of this problem?
   </h3>
   <p>
    Immediately restored the inbound mail service for Jira by manually correcting the aliases file
   </p>
   <h3>
    What can be done to minimize the impact if a problem like this recurs?
   </h3>
   <p>
    Fixed the configuration issue first. Then fix the ansible code
   </p>
   <h2>
    Avoidance
   </h2>
   <hr/>
   <h3>
    What can we do in the future to avoid a problem like this?
   </h3>
   <p>
    Test, test, test.  We need to test thoroughly to ensure inbound and outbound mail service for Jira continue to work after any mail config changes on pdx-mail-lv02
   </p>
   <h2>
    Next Actions
   </h2>
   <hr/>
   <p>
    <ac:placeholder>
     After analyzing and talking about this incident what actions did the reviewers and management decide should be done to address shortfalls in detection, mitigation or avoidance. Use tasks, assignments and due dates or link to created jira tickets.
    </ac:placeholder>
   </p>
   <ac:task-list>
    <ac:task>
     <ac:task-id>
      1
     </ac:task-id>
     <ac:task-status>
      complete
     </ac:task-status>
     <ac:task-body>
      <ac:structured-macro ac:macro-id="f335bec0-bae4-4ea2-bf55-bfb071e8ef1d" ac:name="jira" ac:schema-version="1">
       <ac:parameter ac:name="server">
        System JIRA
       </ac:parameter>
       <ac:parameter ac:name="serverId">
        ac6def98-2140-30c3-8103-4b52b8b31135
       </ac:parameter>
       <ac:parameter ac:name="key">
        ITDW-999
       </ac:parameter>
      </ac:structured-macro>
     </ac:task-body>
    </ac:task>
   </ac:task-list>
   <h2>
    Related articles
   </h2>
   <hr/>
   <p>
    <ac:placeholder>
     Related articles appear here based on the labels you select. Click to edit the macro and add or change labels.
    </ac:placeholder>
   </p>
   <p>
    <ac:structured-macro ac:macro-id="ffeb327a-3070-4405-823e-4605184c1568" ac:name="contentbylabel" ac:schema-version="4">
     <ac:parameter ac:name="showLabels">
      false
     </ac:parameter>
     <ac:parameter ac:name="max">
      5
     </ac:parameter>
     <ac:parameter ac:name="spaces">
      SYSMGR
     </ac:parameter>
     <ac:parameter ac:name="showSpace">
      false
     </ac:parameter>
     <ac:parameter ac:name="sort">
      modified
     </ac:parameter>
     <ac:parameter ac:name="reverse">
      true
     </ac:parameter>
     <ac:parameter ac:name="type">
      page
     </ac:parameter>
     <ac:parameter ac:name="cql">
      label = "kb-how-to-article" and type = "page" and space = "SYSMGR"
     </ac:parameter>
     <ac:parameter ac:name="labels">
      kb-how-to-article
     </ac:parameter>
    </ac:structured-macro>
   </p>
   <ac:structured-macro ac:macro-id="b77901a8-fc07-43f9-b345-36673b35c2e9" ac:name="details" ac:schema-version="1">
    <ac:parameter ac:name="hidden">
     true
    </ac:parameter>
    <ac:rich-text-body>
     <p class="auto-cursor-target">
      <br/>
     </p>
     <table class="wrapped">
      <colgroup>
       <col/>
       <col/>
      </colgroup>
      <tbody>
       <tr>
        <th>
         Related issues
        </th>
        <td>
         <br/>
        </td>
       </tr>
      </tbody>
     </table>
     <p class="auto-cursor-target">
      <br/>
     </p>
    </ac:rich-text-body>
   </ac:structured-macro>
   <p class="auto-cursor-target">
    <br/>
   </p>
  </ac:layout-cell>
 </ac:layout-section>
</ac:layout>
