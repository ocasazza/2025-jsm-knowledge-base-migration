<ac:layout>
 <ac:layout-section ac:type="single">
  <ac:layout-cell>
   <p>
    <ac:placeholder>
     Add labels to this report to make it easy to find outages that relate to the service or the sites that were affected. That will help us find and report on relevant related issues.
    </ac:placeholder>
   </p>
   <ac:structured-macro ac:macro-id="6041cfab-a8b7-40c8-aa32-0229b207b0df" ac:name="excerpt" ac:schema-version="1">
    <ac:parameter ac:name="atlassian-macro-output-type">
     INLINE
    </ac:parameter>
    <ac:rich-text-body>
     <p>
      SIR for
      <span style="color: rgb(23,43,77);">
       Confluence Outage
      </span>
      on
      <span style="color: rgb(23,43,77);">
       05/06/2
      </span>
     </p>
    </ac:rich-text-body>
   </ac:structured-macro>
   <p class="auto-cursor-target">
    <br/>
   </p>
  </ac:layout-cell>
 </ac:layout-section>
 <ac:layout-section ac:type="two_equal">
  <ac:layout-cell>
   <p class="auto-cursor-target">
    <br/>
   </p>
   <ac:structured-macro ac:macro-id="b2a57857-7f56-44d2-a0d4-91b3d7ebfcbf" ac:name="toc-zone" ac:schema-version="1">
    <ac:rich-text-body>
     <p>
      <ac:structured-macro ac:macro-id="58b18781-a929-4005-a5e0-2ef23adca3fe" ac:name="toc" ac:schema-version="1">
      </ac:structured-macro>
     </p>
    </ac:rich-text-body>
   </ac:structured-macro>
   <p class="auto-cursor-target">
    <br/>
   </p>
  </ac:layout-cell>
  <ac:layout-cell>
   <p class="auto-cursor-target">
    <br/>
   </p>
   <ac:structured-macro ac:macro-id="0db3d9b8-3a8d-4ad4-ae26-0a4ea4bc95c2" ac:name="details" ac:schema-version="1">
    <ac:parameter ac:name="id">
     SIR-metadata
    </ac:parameter>
    <ac:rich-text-body>
     <p class="auto-cursor-target">
      <br/>
     </p>
     <table class="wrapped" style="letter-spacing: 0.0px;">
      <colgroup>
       <col/>
       <col/>
      </colgroup>
      <tbody>
       <tr>
        <th colspan="1">
         System/Service
        </th>
        <td colspan="1">
         <ac:link>
          <ri:page ri:content-title="Confluence Server" ri:space-key="SYSMGR">
          </ri:page>
         </ac:link>
        </td>
       </tr>
       <tr>
        <th>
         Ticket(s)
        </th>
        <td>
         <div class="content-wrapper">
          <p>
           <ac:structured-macro ac:macro-id="52624a11-dcd7-4aa4-a7eb-933104347602" ac:name="jira" ac:schema-version="1">
            <ac:parameter ac:name="server">
             System JIRA
            </ac:parameter>
            <ac:parameter ac:name="columnIds">
             issuekey,summary,issuetype,created,updated,duedate,assignee,reporter,priority,status,resolution
            </ac:parameter>
            <ac:parameter ac:name="columns">
             key,summary,type,created,updated,due,assignee,reporter,priority,status,resolution
            </ac:parameter>
            <ac:parameter ac:name="serverId">
             ac6def98-2140-30c3-8103-4b52b8b31135
            </ac:parameter>
            <ac:parameter ac:name="key">
             SYSMGR-64932
            </ac:parameter>
           </ac:structured-macro>
          </p>
         </div>
        </td>
       </tr>
       <tr>
        <th colspan="1">
         Outage scope
        </th>
        <td colspan="1">
         <span style="color: rgb(51,51,51);">
          <span style="background-color: rgb(245,245,245);">
           <em>
            All users in the organization could not access this service.
           </em>
          </span>
         </span>
        </td>
       </tr>
       <tr>
        <th>
         Outage date
        </th>
        <td>
         <div class="content-wrapper">
          <p>
           <time datetime="2022-05-06">
           </time>
          </p>
         </div>
        </td>
       </tr>
       <tr>
        <th>
         Report date
        </th>
        <td>
         <div class="content-wrapper">
          <p>
           <time datetime="2022-05-06">
           </time>
          </p>
         </div>
        </td>
       </tr>
       <tr>
        <th colspan="1">
         Report filed by
        </th>
        <td colspan="1">
         <div class="content-wrapper">
          <p>
           <ac:link>
            <ri:user ri:userkey="557058:9290142c-5161-42cc-b65b-d8b8487fa532">
            </ri:user>
           </ac:link>
          </p>
         </div>
        </td>
       </tr>
       <tr>
        <th colspan="1">
         Report reviewed date
        </th>
        <td colspan="1">
         <div class="content-wrapper">
          <p>
           <time datetime="2022-05-23">
           </time>
           <span style="color: rgb(23,43,77);">
           </span>
          </p>
         </div>
        </td>
       </tr>
       <tr>
        <th colspan="1">
         Reviewed by
        </th>
        <td colspan="1">
         <div class="content-wrapper">
          <p>
           <ac:link>
            <ri:user ri:userkey="557058:898bb344-b31e-4ae9-b386-376a86469c7d">
            </ri:user>
           </ac:link>
          </p>
         </div>
        </td>
       </tr>
      </tbody>
     </table>
     <p class="auto-cursor-target">
      <br/>
     </p>
    </ac:rich-text-body>
   </ac:structured-macro>
   <p class="auto-cursor-target">
    <br/>
   </p>
  </ac:layout-cell>
 </ac:layout-section>
 <ac:layout-section ac:type="single">
  <ac:layout-cell>
   <h2>
    Executive summary
   </h2>
   <hr/>
   <p>
    PagerDuty alerted the primary on-call (
    <ac:link>
     <ri:user ri:userkey="557058:9290142c-5161-42cc-b65b-d8b8487fa532">
     </ri:user>
    </ac:link>
    ) that Confluence was down.
    <ac:link>
     <ri:user ri:userkey="557058:9290142c-5161-42cc-b65b-d8b8487fa532">
     </ri:user>
    </ac:link>
    restarted the service but that did not resolve the issue. We later discovered a Java process that was running was the cause of Confluence not being available after the external weekly reboots. Killing the Java process and restarting confluence resolved the issue.
   </p>
   <p>
    <br/>
   </p>
   <h2>
    <span>
     Background
    </span>
   </h2>
   <hr/>
   <p>
    <span style="color: rgb(0,0,0);">
     Confluence is a web-based corporate wiki utilized at Schrodinger to create and provide documentation to users throughout the organization. Confluence is an essential service to the organization and must be monitored and available to enhance work performance.
    </span>
   </p>
   <h2>
    Incident Description
   </h2>
   <hr/>
   <p>
    <span style="color: rgb(23,43,77);">
     The incident is summarized in the Chronology section below.
    </span>
   </p>
   <h3>
    Chronology
   </h3>
   <p>
    PagerDuty alerted
    <ac:link>
     <ri:user ri:userkey="557058:9290142c-5161-42cc-b65b-d8b8487fa532">
     </ri:user>
    </ac:link>
    at 10:40pm Eastern.
   </p>
   <p>
    <ac:link>
     <ri:user ri:userkey="557058:9290142c-5161-42cc-b65b-d8b8487fa532">
     </ri:user>
    </ac:link>
    Acknowledged the alert at 10:50PM Eastern.
   </p>
   <p>
    After restarting the service on gcp-confluence-lv01 confluence was still inaccessible.
   </p>
   <p>
    <ac:link>
     <ri:user ri:userkey="557058:9290142c-5161-42cc-b65b-d8b8487fa532">
     </ri:user>
    </ac:link>
    Reached out in the IT-SOS hotline room for assistance with the issue.
   </p>
   <p>
    <ac:link>
     <ri:user ri:userkey="640b97dd93cf25994632639f">
     </ri:user>
    </ac:link>
    chimed in and provided some suggestions as to what could be the cause.
    <ac:link>
     <ri:user ri:userkey="557058:898bb344-b31e-4ae9-b386-376a86469c7d">
     </ri:user>
    </ac:link>
    began to assist and ssh'd to gcp-confluence-lv01 as the pagerduty alert was escalated.
    <ac:link>
     <ri:user ri:userkey="5d405c8181cbd30da3475cdf">
     </ri:user>
    </ac:link>
    also began to look into what caused the service interruption.
   </p>
   <p>
    <ac:link>
     <ri:user ri:userkey="557058:9290142c-5161-42cc-b65b-d8b8487fa532">
     </ri:user>
    </ac:link>
    ,
    <ac:link>
     <ri:user ri:userkey="557058:898bb344-b31e-4ae9-b386-376a86469c7d">
     </ri:user>
    </ac:link>
    <ac:link>
     <ri:user ri:userkey="5d405c8181cbd30da3475cdf">
     </ri:user>
    </ac:link>
    began to comb through the logs for more information.
   </p>
   <p>
    <ac:link>
     <ri:user ri:userkey="5d405c8181cbd30da3475cdf">
     </ri:user>
    </ac:link>
    discovered in the catalina.ou log file that the apache failed to start on port 8000 because the port was in use by a Java service.
   </p>
   <p>
    Simon Keng pinged the IT Support line asking if Confluence was down.
   </p>
   <p>
    At 11:30pm EST
    <ac:link>
     <ri:user ri:userkey="5d405c8181cbd30da3475cdf">
     </ri:user>
    </ac:link>
    Killed the Java process and restarted Confluence and service was restored.
   </p>
   <p>
    <br/>
   </p>
   <h3>
    Corrective Action
   </h3>
   <p>
    Killing the Java process that was using port:8000 and restarting Confluence.
   </p>
   <ac:structured-macro ac:macro-id="70d4397c-64d5-47d0-9594-3c6ff0832a3f" ac:name="code" ac:schema-version="1">
    <ac:plain-text-body>
     <![CDATA[ps aux | grep java
conflue+    1466 13.3 15.3 14956120 5060356 ?    Sl   02:40   6:07 /dstore/atlassian/confluence/jre//bin/java -Djava.util.logging.config.file=/dstore/atlassian/confluence/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djdk.tls.ephemeralDHKeySize=2048 -Djava.protocol.handler.pkgs=org.apache.catalina.webresources -Dorg.apache.catalina.security.SecurityListener.UMASK=0027 -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/dstore/staging/dumps/heaps -XX:ReservedCodeCacheSize=256m -XX:+UseCodeCacheFlushing -Dconfluence.context.path= -Datlassian.plugins.startup.options= -Dorg.apache.tomcat.websocket.DEFAULT_BUFFER_SIZE=32768 -Dsynchrony.enable.xhr.fallback=true -Djavax.net.ssl.trustStorePassword=changeit -Djavax.net.ssl.trustStore=/dstore/atlassian/confluence/jre/lib/security/cacerts -Xms8192m -Xmx8192m -XX:+UseG1GC -Datlassian.plugins.enable.wait=300 -Djava.awt.headless=true -XX:G1ReservePercent=20 -Xlog:gc:/dstore/atlassian/confluence/logs/gc-2022-05-07_02-40-38.log -XX:-PrintGCDetails -Dignore.endorsed.dirs= -classpath /dstore/atlassian/confluence/bin/bootstrap.jar:/dstore/atlassian/confluence/bin/tomcat-juli.jar -Dcatalina.base=/dstore/atlassian/confluence -Dcatalina.home=/dstore/atlassian/confluence -Djava.io.tmpdir=/dstore/atlassian/confluence/temp org.apache.catalina.startup.Bootstrap start
conflue+    2871  2.8  3.0 8276084 990996 ?      Sl   02:42   1:13 /dstore/atlassian/confluence/jre/bin/java -classpath /dstore/atlassian/confluence/temp/4.0.0-master-f680ea21.jar:/dstore/atlassian/confluence/confluence/WEB-INF/lib/postgresql-42.2.18.jar -Xss2048k -Xmx2g synchrony.core sql
root        5501  0.0  0.0   8168  2400 pts/1    S+   03:26   0:00 grep --color=auto java]]>
    </ac:plain-text-body>
   </ac:structured-macro>
   <p>
    <br/>
   </p>
   <p>
    <span style="font-size: 16.0px;font-weight: bold;letter-spacing: -0.006em;">
     Analysis
    </span>
   </p>
   <p>
    <br/>
   </p>
   <p>
    <br/>
   </p>
   <h2>
    Detection
   </h2>
   <hr/>
   <h3>
    How quickly was the problem detected?
   </h3>
   <p>
    The problem was detected and acknowledged 10 minutes after the pagerduty alert was sent to the on-call person.
   </p>
   <h3>
    How was the problem detected?
   </h3>
   <p>
    <span style="color: rgb(23,43,77);">
     The problem was detected by Pingdom. Pingdom couldn't connect to Confluence.
    </span>
   </p>
   <p>
    Pingdom
    <span style="letter-spacing: 0.0px;">
     /PagerDuty
    </span>
   </p>
   <h3>
    How can detection be improved?
   </h3>
   <p>
    No recommendations for improvement here. Pagerduty did its job.
   </p>
   <h2>
    Response
   </h2>
   <hr/>
   <h3>
    How quickly did we respond once detected?
   </h3>
   <p>
    10 Minutes after the Pagerduty alert was sent.
   </p>
   <h3>
    Did we adequately communicate to our users?
   </h3>
   <p>
    We did not communicate to our end-users as it was after work hours and we was focused on fixing the issue. (Room for Improvement here.)
   </p>
   <h3>
    If not, how can this be improved?
   </h3>
   <p>
    We should have notified our end users through the IT Support-line of the outage.
   </p>
   <p>
    Create a basic email template that the teams can use to quickly modify to send out email communication during a service interruption.
   </p>
   <p>
    <br/>
   </p>
   <h2>
    Mitigation
   </h2>
   <hr/>
   <h3>
    What went well that helped minimize the impact of this problem?
   </h3>
   <p>
    Team work. I did not feel alone during this incident. The Team quickly assisted when I could not find the solution
   </p>
   <h3>
    What can be done to minimize the impact if a problem like this recurs?
   </h3>
   <p>
    Since confluence was down we did not have access to the document which could have been valuable (
    <ac:link>
     <ri:page ri:content-title="Start/stop Confluence services" ri:space-key="SYSMGR">
     </ri:page>
    </ac:link>
    ). We should have a copy of this document ins Freshservice or a Google Drive folder.
   </p>
   <h2>
    Avoidance
   </h2>
   <hr/>
   <h3>
    What can we do in the future to avoid a problem like this?
   </h3>
   <p>
    <span style="color: rgb(32,33,36);">
     We should schedule a service window to investigate exactly what's going on with reboot/restart Confluence. Figuring out what's causing the restart issue and addressing the issue is necessary since Confluence is now on regular reboot schedule. The very issue may happen again without any action. Spun off
     <ac:structured-macro ac:macro-id="f0512267-975a-4151-9af1-534564785d97" ac:name="jira" ac:schema-version="1">
      <ac:parameter ac:name="server">
       System JIRA
      </ac:parameter>
      <ac:parameter ac:name="serverId">
       ac6def98-2140-30c3-8103-4b52b8b31135
      </ac:parameter>
      <ac:parameter ac:name="key">
       ITDW-311
      </ac:parameter>
     </ac:structured-macro>
     for the further investigation.
    </span>
   </p>
   <p>
    <br/>
   </p>
   <h2>
    Next Actions
   </h2>
   <hr/>
   <p>
    <ac:placeholder>
     After analyzing and talking about this incident what actions did the reviewers and management decide should be done to address shortfalls in detection, mitigation or avoidance. Use tasks, assignments and due dates or link to created jira tickets.
    </ac:placeholder>
   </p>
   <ac:task-list>
    <ac:task>
     <ac:task-id>
      1
     </ac:task-id>
     <ac:task-status>
      complete
     </ac:task-status>
     <ac:task-body>
      <ac:structured-macro ac:macro-id="469121f2-69da-4a1a-9bd4-3995b59e2fef" ac:name="jira" ac:schema-version="1">
       <ac:parameter ac:name="server">
        System JIRA
       </ac:parameter>
       <ac:parameter ac:name="serverId">
        ac6def98-2140-30c3-8103-4b52b8b31135
       </ac:parameter>
       <ac:parameter ac:name="key">
        ITDW-311
       </ac:parameter>
      </ac:structured-macro>
     </ac:task-body>
    </ac:task>
    <ac:task>
     <ac:task-id>
      3
     </ac:task-id>
     <ac:task-status>
      complete
     </ac:task-status>
     <ac:task-body>
      <time datetime="2022-08-05">
      </time>
      is the next Confluence restart window. Let's do our due diligence before then please.
     </ac:task-body>
    </ac:task>
    <ac:task>
     <ac:task-id>
      5
     </ac:task-id>
     <ac:task-status>
      complete
     </ac:task-status>
     <ac:task-body>
      <a class="issue-link" href="https://schrodinger.atlassian.net/browse/ITINFRA-397">
       ITINFRA-397
      </a>
      Reboot Confluence to investigate.
     </ac:task-body>
    </ac:task>
   </ac:task-list>
   <p>
    <br/>
   </p>
   <h2>
    Related articles
   </h2>
   <hr/>
   <p>
    <ac:placeholder>
     Related articles appear here based on the labels you select. Click to edit the macro and add or change labels.
    </ac:placeholder>
   </p>
   <p>
    <ac:structured-macro ac:macro-id="ffeb327a-3070-4405-823e-4605184c1568" ac:name="contentbylabel" ac:schema-version="4">
     <ac:parameter ac:name="showLabels">
      false
     </ac:parameter>
     <ac:parameter ac:name="max">
      5
     </ac:parameter>
     <ac:parameter ac:name="spaces">
      SYSMGR
     </ac:parameter>
     <ac:parameter ac:name="showSpace">
      false
     </ac:parameter>
     <ac:parameter ac:name="sort">
      modified
     </ac:parameter>
     <ac:parameter ac:name="reverse">
      true
     </ac:parameter>
     <ac:parameter ac:name="type">
      page
     </ac:parameter>
     <ac:parameter ac:name="cql">
      label = "kb-how-to-article" and type = "page" and space = "SYSMGR"
     </ac:parameter>
     <ac:parameter ac:name="labels">
      kb-how-to-article
     </ac:parameter>
    </ac:structured-macro>
   </p>
   <ac:structured-macro ac:macro-id="b77901a8-fc07-43f9-b345-36673b35c2e9" ac:name="details" ac:schema-version="1">
    <ac:parameter ac:name="hidden">
     true
    </ac:parameter>
    <ac:rich-text-body>
     <p class="auto-cursor-target">
      <br/>
     </p>
     <table class="wrapped">
      <colgroup>
       <col/>
       <col/>
      </colgroup>
      <tbody>
       <tr>
        <th>
         Related issues
        </th>
        <td>
         <br/>
        </td>
       </tr>
      </tbody>
     </table>
     <p class="auto-cursor-target">
      <br/>
     </p>
    </ac:rich-text-body>
   </ac:structured-macro>
   <p class="auto-cursor-target">
    <br/>
   </p>
  </ac:layout-cell>
 </ac:layout-section>
</ac:layout>
